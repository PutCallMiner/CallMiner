{% extends "layout.html.jinja2" %}

{% block content %}

<main id="transcripts">
  <div id="controls">
    <input type="search" placeholder="Search" >
  </div>
  <div class="table">
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Topic</th>
          <th>Agent</th>
          <th>Score</th>
          <th>Duration</th>
          <th>Tags</th>
          <th>Date</th>
        </tr>
      </thead>
      <tbody>
        {% for transcript in transcripts %}
        <tr>
          <td>
            <a href="{{ '/transcripts/' ~ transcript.id  }}" title="Go to Details">
              #{{ transcript.id }}<span class="icon">north_east</span>
            </a>
          </td>
          <td>
            <a href="{{ '/transcripts/' ~ transcript.id ~ '/quick' }}" title="See Summary">
              {{ transcript.topic }}<span class="icon">search</span>
            </a>
          </td>
          <td>
            <button class="chip">
              <object type="image/jpeg"></object>
              {{ transcript.agent }}
            </button>
          </td>
          <td>
            {% set score = "#fd8a8a" if transcript.score < 33 else "#f3d17c" if transcript.score < 66 else "#b8d8be" %}
            <div class="rating" style="{{ 'background-image: conic-gradient(' ~ score ~ ' ' ~ transcript.score ~ '%, transparent 0 100%);' }}">
              <span>{{ transcript.score }}</span>
            </div>
          </td>
          <td>{{ transcript.duration_secs // 60 ~ " min" }}</td>
          <td>
            {% for tag in transcript.tags %}
            <button class="chip">
              {{ tag }}
            </button>
            {% endfor %}
          </td>
          <td>{{ transcript.timestamp.strftime('%b %d, %Y') }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    <div class="pagination">
      <div>
        <span>Show</span>
        <select>
        {% for t in [5, 10, 20, 50] %}
          <option value="{{ l }}" {% if t == take %}selected{% endif %}>{{ t }}</option>
        {% endfor %}
        </select>
        <span>results</span>
      </div>
      <div>
        {% if skip > 0 %}
          <a href="{{ '/transcripts?skip=' ~ (skip - take, 0)|max ~ '&take=' ~ take  }}">
            <span class="icon">chevron_left</span><span>Previous</span>
          </a>
        {% endif %}
        <select>
          {% for s in range(0, total + 1, take) %}
            <option value="{{ s }}" {% if s == skip %}selected{% endif %}>{{ s // take + 1 }}</option>
          {% endfor %} 
        </select>
        <span>of {{ total // take + 1 }}</span>
        {% if skip + take < total %}
          <a href="{{ '/transcripts?skip=' ~ (skip + take + 1, total)|min ~ '&take=' ~ take  }}">
            <span>Next</span><span class="icon">chevron_right</span>
          </a>
        {% endif %}
      </div>
    </div>
  </div>
</main>

{% endblock %}
